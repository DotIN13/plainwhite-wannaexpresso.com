<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="google-site-verification" content="zrVlHARQzSGPX8n0jKJdP_fCO0AvtLXxoPmYkJh-oXw"/><meta name="description" content="Act local, think global with DotIN13!"><meta name="keywords" content="Linux, Jekyll, Blog, and Searchbar"><meta name="theme-color" content="#ff94c2"><meta lang="zh"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png?v=2bA3g2vyYK"><link rel="mask-icon" href="/assets/img/favicon/safari-pinned-tab.svg?v=2bA3g2vyYK" color="#dc2267"><link rel="shortcut icon" href="/assets/img/favicon/favicon.ico?v=2bA3g2vyYK"><meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/img/favicon/browserconfig.xml?v=2bA3g2vyYK"><meta property="og:title" content="为博客添加简单的全局搜索 - DOTIN13'S BLOG"><meta property="og:type" content="article"><meta property="og:description" content="这不是一篇教程 看到Spotlog有非常酷炫的搜索功能，虽然心里知道Hux在创造Hux Blog这个主题的时候就是本着简介明了的原则来创作的，但是还是手痒。无奈Spotq同学没有放出具体实现的代码，况且又封了仓（GitHub），于是便只能自己动手来制作。 前端苦手 Hux在创作主题的时候使用的是Bootstrap 3.3，于是便想利用便利的框架来直接将搜索框插入Navbar。无奈，多次..."><meta property="article:published_time" content="2020-03-14T00:00:00Z"><meta property="article:author" content="DotIN13"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Jekyll"><meta property="article:tag" content="Blog"><meta property="article:tag" content="Searchbar"><meta property="og:image" content="https://www.wannaexpresso.com/assets/img/orange.webp"><meta property="og:url" content="https://www.wannaexpresso.com/2020/03/14/jekyll-blog-searchbar/"><meta property="og:site_name" content="DOTIN13'S BLOG"><link rel="canonical" href="https://www.wannaexpresso.com/2020/03/14/jekyll-blog-searchbar/"><script src="/assets/public/application-bundle.js"></script><link rel="stylesheet" href="/assets/public/application.css"><script src="/assets/public/posts-bundle.js"></script><title>为博客添加简单的全局搜索 - DOTIN13'S BLOG</title></head><body><main class="container"><section class="about"><div class="about-header"><div class="about-title"><a href="/" id="avatar" data-caption="DotIN13" data-webpack="true" data-path="/assets/img/orange.webp"></a><h2 id="title"><a href="/">DotIN13</a></h2></div><p class="tagline">LACKAWANNA<br>EXPRESSO</p></div><div class="buttons"><a href="/en-us/" class="language-selection button icon-translate" aria-label="Change locale to English."></a><a href="/feed.xml" class="feed button icon-rss_feed" aria-label="RSS Feed"></a><input type="checkbox" class="dark-mode-toggle" aria-label="dark-mode-switch"><a href="#" aria-label="Click to toggle darkmode." class="button"><span class="icon-moon"></span><span class="icon-sun"></span></a><a href="#" id="pwa-install" class="install button icon-install disabled" aria-label="Install as Web Application"><span>Install</span></a></div><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></section><section class="content"><div class="post-container"><a class="post-link" href="/2020/03/14/jekyll-blog-searchbar/"><h2 class="post-title">为博客添加简单的全局搜索</h2><h3 class="post-subtitle">Adding Simple Global Search to Jekyll Blog</h3></a><div class="post-meta"><div class="post-categories"><a class="button" href="/archive/?tag=Linux" title="Linux">Linux</a><a class="button" href="/archive/?tag=Jekyll" title="Jekyll">Jekyll</a><a class="button" href="/archive/?tag=Blog" title="Blog">Blog</a><a class="button" href="/archive/?tag=Searchbar" title="Searchbar">Searchbar</a></div><div class="post-misc"><div class="post-date"><i class="icon-calendar"></i>Mar 14, 2020</div></div></div><div class="post"><h2 id="这不是一篇教程"><a href="#这不是一篇教程">#</a> 这不是一篇教程 </h2><p>看到<a href="https://soptq.me/2019/04/03/implement-search/#jekyll-feature" target="_blank" rel="nofollow noopener noreferrer">Spotlog</a>有非常酷炫的搜索功能，虽然心里知道Hux在创造<code class="language-plaintext highlighter-rouge">Hux Blog</code>这个主题的时候就是本着简介明了的原则来创作的，但是还是手痒。无奈Spotq同学没有放出具体实现的代码，况且又封了仓（GitHub），于是便只能自己动手来制作。</p><h2 id="前端苦手"><a href="#前端苦手">#</a> 前端苦手 </h2><p>Hux在创作主题的时候使用的是<code class="language-plaintext highlighter-rouge">Bootstrap 3.3</code>，于是便想利用便利的框架来直接将搜索框插入Navbar。无奈，多次尝试之后以失败告终，网上copy来的代码要不就是根本不起效，要不就是不够美观。</p><p>失败了一个下午之后，只好决定将搜索框放到右侧的侧边栏中，唯一的问题就是在移动设备上搜索框会出现在界面的最下方。我设想的形式是左边有一个搜索标志，右侧是输入框，结果直接在下方的<code class="language-plaintext highlighter-rouge">&lt;ul&gt;</code>中显示。</p><p>首先遇到的问题是，Hux Blog的侧边栏有一个bug，也就是Featured Tags栏目下方的elements也被计算作了tags，导致这一<code class="language-plaintext highlighter-rouge">&lt;section&gt;</code>下方的<code class="language-plaintext highlighter-rouge">&lt;hr&gt;</code>以及我添加的<code class="language-plaintext highlighter-rouge">&lt;input&gt;</code>都被套上了<code class="language-plaintext highlighter-rouge">&lt;a&gt;</code>，搜索框每次被点击都会自动跳转。经过长时间的研究，发现问题应该就在这一句中：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{{ tags | split:'<span class="nt">&lt;/a&gt;</span>' | sort | join:'<span class="nt">&lt;/a&gt;</span>'}}

</code></pre></div></div><p>但——我解决不了，因为我的liquid知识实在太少。最后，折衷的办法是，从不存在这一bug的旧版的Hux Blog主题中拷贝代码，最后的结果就是侧边栏的tags不能再自动排序。</p><blockquote><p>Edit：这一问题在最新的Hux Blog主题中已经由Hux修复，解决的方法是将_includes/featured-tags.html中的部分代码修改为：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
...
<span class="nt">&lt;a&gt;</span>...<span class="nt">&lt;/a&gt;</span>__SEPARATOR__
{% endif %}{% endfor %}
{% endcapture %}
{{ tags | split:'__SEPARATOR__' | sort }}

</code></pre></div></div><p>具体的做法请参阅Hux Blog的Commits。</p></blockquote><p>解决了这一问题之后，便着手编写搜索框的代码。结构很简单，一个<code class="language-plaintext highlighter-rouge">&lt;div&gt;</code>里装着搜索glyph，一个<code class="language-plaintext highlighter-rouge">&lt;input&gt;</code>用于输入。我想像Bootstrap Docs一样使得左边的<code class="language-plaintext highlighter-rouge">&lt;div&gt;</code>与右边的<code class="language-plaintext highlighter-rouge">&lt;input&gt;</code>同高，但始终做不到，传统的<code class="language-plaintext highlighter-rouge">display: inline-block</code>写法在PC上同高，但到了移动设备上又不同高了。查阅资料发现，要让两者同高，得采用<code class="language-plaintext highlighter-rouge">display: flex</code>的方式，让两个元素同处一个限位<code class="language-plaintext highlighter-rouge">&lt;div&gt;</code>之中，并以盒模型的方式显示，才能够让两者真正保持统一高度。</p><p>于是，就有了以下的的代码：</p><p class="codepen" data-height="265" data-theme-id="light" data-default-tab="css,result" data-user="DotIN13" data-slug-hash="dyomaqQ" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Search Bar"><span>See the Pen <a href="https://codepen.io/DotIN13/pen/dyomaqQ"> Search Bar</a> by DotIN13 (<a href="https://codepen.io/DotIN13">@DotIN13</a>) on <a href="https://codepen.io">CodePen</a>.</span></p><script async="" src="https://static.codepen.io/assets/embed/ei.js"></script><h2 id="造轮子"><a href="#造轮子">#</a> 造轮子 </h2><p>有的时候，造轮子真的对一个蹩脚的木匠来说，比登天还难，但有一位伟大的哲人Hyt曾经说过：“我觉得造轮子就是一个学习的过程，等你会造轮子了，也就真正知道轮子怎么用了”。</p><p>在不断的尝试、不断的试错中，人才能成长，不是吗。</p></div><ul class="post-pager"><li class="pager--next"><a class="button" href="/2020/03/14/move-to-zeit/" data-toggle="tooltip" data-placement="top" title="从GitHub Page迁移到Zeit Now"> NEXT<br><span>从GitHub Page迁移到Zeit Now</span></a></li><li class="pager--prev"><a class="button" href="/2020/03/08/how-viruses-infect-molecular-biology/" data-toggle="tooltip" data-placement="top" title="高中生物：遗传物质的转录与翻译"> PREV<br><span>高中生物：遗传物质的转录与翻译</span></a></li></ul><div id="vcomments"></div></div></section><footer class="about condensed"><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></footer></main><script async src="https://www.googletagmanager.com/gtag/js?id=UA-159368053-1"></script><script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-159368053-1');
    </script></body></html>