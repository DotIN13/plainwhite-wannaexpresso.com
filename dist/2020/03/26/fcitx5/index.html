<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="google-site-verification" content="zrVlHARQzSGPX8n0jKJdP_fCO0AvtLXxoPmYkJh-oXw"/><meta name="description" content="Act local, think global with DotIN13!"><meta name="keywords" content="Linux, Fcitx, Fcitx5, and Input Method"><meta name="theme-color" content="#ff94c2"><meta lang="zh"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png?v=2bA3g2vyYK"><link rel="mask-icon" href="/assets/img/favicon/safari-pinned-tab.svg?v=2bA3g2vyYK" color="#dc2267"><link rel="shortcut icon" href="/assets/img/favicon/favicon.ico?v=2bA3g2vyYK"><meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/img/favicon/browserconfig.xml?v=2bA3g2vyYK"><meta property="og:title" content="在Manjaro上优雅地使用Fcitx5 - DOTIN13'S BLOG"><meta property="og:type" content="article"><meta property="og:description" content="从fcitx4到fcitx5 fcitx4的使用体验说好不好，说差不差。连着换了三个封装，最终还是因为各种各样的问题令我头疼。一开始我使用的是fcitx-rime，然而rime有一个小问题，就是在输入一段时间之后会无法切换中英文，非常难受。稍后更换的google-pinyin不能添加模糊音，sunpinyin的词库稍稍有些不顺手。 在网上翻找，发现fcitx5的开发已经进入第三个年头，并..."><meta property="article:published_time" content="2020-03-26T00:00:00Z"><meta property="article:author" content="DotIN13"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Fcitx"><meta property="article:tag" content="Fcitx5"><meta property="article:tag" content="Input Method"><meta property="og:image" content="https://www.wannaexpresso.com/assets/img/orange.webp"><meta property="og:url" content="https://www.wannaexpresso.com/2020/03/26/fcitx5/"><meta property="og:site_name" content="DOTIN13'S BLOG"><link rel="canonical" href="https://www.wannaexpresso.com/2020/03/26/fcitx5/"><script src="/assets/public/application-bundle.js"></script><link rel="stylesheet" href="/assets/public/application.css"><script src="/assets/public/posts-bundle.js"></script><title>在Manjaro上优雅地使用Fcitx5 - DOTIN13'S BLOG</title></head><body><main class="container"><section class="about"><div class="about-header"><div class="about-title"><a href="/" id="avatar" data-caption="DotIN13" data-webpack="true" data-path="/assets/img/orange.webp"></a><h2 id="title"><a href="/">DotIN13</a></h2></div><p class="tagline">LACKAWANNA<br>EXPRESSO</p></div><div class="buttons"><a href="/en-us/" class="language-selection button icon-translate" aria-label="Change locale to English."></a><a href="/feed.xml" class="feed button icon-rss_feed" aria-label="RSS Feed"></a><input type="checkbox" class="dark-mode-toggle" aria-label="dark-mode-switch"><a href="#" aria-label="Click to toggle darkmode." class="button"><span class="icon-moon"></span><span class="icon-sun"></span></a><a href="#" id="pwa-install" class="install button icon-install disabled" aria-label="Install as Web Application"><span>Install</span></a></div><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></section><section class="content"><div class="post-container"><a class="post-link" href="/2020/03/26/fcitx5/"><h2 class="post-title">在Manjaro上优雅地使用Fcitx5</h2><h3 class="post-subtitle">Using Fcitx5 Elegantly on Linux Manjaro</h3></a><div class="post-meta"><div class="post-categories"><a class="button" href="/archive/?tag=Linux" title="Linux">Linux</a><a class="button" href="/archive/?tag=Fcitx" title="Fcitx">Fcitx</a><a class="button" href="/archive/?tag=Fcitx5" title="Fcitx5">Fcitx5</a><a class="button" href="/archive/?tag=Input+Method" title="Input Method">Input Method</a></div><div class="post-misc"><div class="post-date"><i class="icon-calendar"></i>Mar 26, 2020</div></div></div><div class="post"><h2 id="从fcitx4到fcitx5"><a href="#从fcitx4到fcitx5">#</a> 从fcitx4到fcitx5 </h2><p>fcitx4的使用体验说好不好，说差不差。连着换了三个封装，最终还是因为各种各样的问题令我头疼。一开始我使用的是fcitx-rime，然而rime有一个小问题，就是在输入一段时间之后会无法切换中英文，非常难受。稍后更换的google-pinyin不能添加模糊音，sunpinyin的词库稍稍有些不顺手。</p><p>在网上翻找，发现fcitx5的开发已经进入第三个年头，并且在众多archer中是清一色的好评，于是，我便决定从fcitx4迁移到fcitx5。</p><h2 id="安装"><a href="#安装">#</a> 安装 </h2><p>既然是Manjaro，安装fcitx5自然是非常方便。顺带一提，fcitx的官方Repo在<a href="https://github.com/fcitx/fcitx5" target="_blank" rel="nofollow noopener noreferrer">GitHub</a>。</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pacman <span class="nt">-Rs</span> <span class="si">$(</span>pacman <span class="nt">-Qsq</span> fcitx<span class="si">)</span> <span class="c">#卸载fcitx4</span>
pacman <span class="nt">-S</span> fcitx5-chinese-addons fcitx5 fcitx5-gtk fcitx5-qt <span class="c">#安装community源的fcitx5</span>
<span class="c">#你也可以选择用下面的命令安装archlinuxcn源的fcitx5</span>
pacman <span class="nt">-S</span> fcitx5-chinese-addons-git fcitx5-git fcitx5-gtk-git fcitx5-qt5-git
</code></pre></div></div><p>如果你是Debian用户，可以参看<a href="https://iovxw.net/p/fcitx5/" target="_blank" rel="nofollow noopener noreferrer">iovxw安装fcitx5</a>。</p><h2 id="配置group"><a href="#配置group">#</a> 配置Group </h2><p>直接启动fcitx5是只有西文键盘的，如果是KDE，可以到系统的输入法配置启用拼音；如果和我一样是其他发行版，就需要使用配置文件。</p><p>首先在你的Dash或者Monitor找到fcitx5，完全退出，如果fcitx5在运行，修改后软件会自动覆写profile配置文件。</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nano ~/.config/fcitx5/profile <span class="c">#用nano打开profile</span>
vim ~/.config/fcitx5/profile <span class="c">#用vim打开profile</span>
gedit ~/.config/fcitx5/profile <span class="c">#用gedit打开profile</span>
</code></pre></div></div><p>根据<a href="https://www.csslayer.info/wordpress/fcitx-dev/a-new-pinyin-input-method-that-might-be-slightly-better-than-sunpinyin/" target="_blank" rel="nofollow noopener noreferrer">老K同学的指南</a>，替换profile配置文件的全部内容如下：</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">[</span><span class="nv">Groups/0</span><span class="pi">]</span>
<span class="c1"># Group Name</span>
<span class="s">Name=Default</span>
<span class="c1"># Layout</span>
<span class="s">Default Layout=us</span>
<span class="c1"># Default Input Method</span>
<span class="s">DefaultIM=pinyin</span>

<span class="pi">[</span><span class="nv">Groups/0/Items/0</span><span class="pi">]</span>
<span class="c1"># Name</span>
<span class="s">Name=keyboard-us</span>
<span class="c1"># Layout</span>
<span class="s">Layout=</span>

<span class="pi">[</span><span class="nv">Groups/0/Items/1</span><span class="pi">]</span>
<span class="c1"># Name</span>
<span class="s">Name=pinyin</span>
<span class="c1"># Layout</span>
<span class="s">Layout=</span>

<span class="pi">[</span><span class="nv">GroupOrder</span><span class="pi">]</span>
<span class="s">0=Default</span>
</code></pre></div></div><p>可以看到fcitx5的配置文件还是很好理解的。配置文件在注销重新登陆之后就会生效，届时启动fcitx5即可体验。</p><h2 id="配置环境变量"><a href="#配置环境变量">#</a> 配置环境变量 </h2><p>修改<code class="language-plaintext highlighter-rouge">~/.pam_environment</code>，添加如下内容：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">GTK_IM_MODULE</span><span class="o">=</span>fcitx5
<span class="nv">QT_IM_MODULE</span><span class="o">=</span>fcitx5
<span class="nv">XMODIFIERS</span><span class="o">=</span><span class="s2">"@im=fcitx5"</span>
</code></pre></div></div><p>使用<code class="language-plaintext highlighter-rouge">echo ${XDG_SESSION_TYPE}</code>命令查看，如果是x11用户，则还应当在<code class="language-plaintext highlighter-rouge">~/.xprofile</code>添加如下内容：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fcitx5 &amp;
</code></pre></div></div><h2 id="fcitx5-rime"><a href="#fcitx5-rime">#</a> Fcitx5-Rime </h2><p>Fcitx5也支持了Rime封装，使用<code class="language-plaintext highlighter-rouge">pacman -S fcitx5-rime</code>或者<code class="language-plaintext highlighter-rouge">pacman -S fcitx5-rime-git</code>即可安装。</p><p>配置profile文件：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nano ~/.config/fcitx5/profile <span class="c">#用nano打开profile</span>
</code></pre></div></div><p>编辑内容为如下：</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">[</span><span class="nv">Groups/0</span><span class="pi">]</span>
<span class="c1"># Group Name</span>
<span class="s">Name=Default</span>
<span class="c1"># Layout</span>
<span class="s">Default Layout=us</span>
<span class="c1"># Default Input Method</span>
<span class="s">DefaultIM=rime</span>

<span class="pi">[</span><span class="nv">Groups/0/Items/0</span><span class="pi">]</span>
<span class="c1"># Name</span>
<span class="s">Name=keyboard-us</span>
<span class="c1"># Layout</span>
<span class="s">Layout=</span>

<span class="pi">[</span><span class="nv">Groups/0/Items/1</span><span class="pi">]</span>
<span class="c1"># Name</span>
<span class="s">Name=rime</span>
<span class="c1"># Layout</span>
<span class="s">Layout=</span>

<span class="pi">[</span><span class="nv">GroupOrder</span><span class="pi">]</span>
<span class="s">0=Default</span>
</code></pre></div></div><p>新版兼容旧版配置，可以直接使用命令复制配置与词库：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> <span class="nt">-r</span> ~/.config/fcitx/rime ~/.local/share/fcitx5/rime
</code></pre></div></div><p>当然也可以手动选取自己希望保留的配置进行复制。</p><h2 id="个性化"><a href="#个性化">#</a> 个性化 </h2><h3 id="关闭云拼音"><a href="#关闭云拼音">#</a> 关闭云拼音 </h3><p>感谢<a href="https://zjukuny.github.io/posts/fcitx5/" target="_blank" rel="nofollow noopener noreferrer">千玄子</a>的提醒，我关闭了云拼音，以防直播打字。</p><p>修改<code class="language-plaintext highlighter-rouge">~/.config/fcitx5/conf/pinyin.conf</code>：</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Enable Cloud Pinyin</span>
<span class="nv">CloudPinyinEnabled</span><span class="o">=</span>False
</code></pre></div></div><h3 id="关闭自动dpi"><a href="#关闭自动dpi">#</a> 关闭自动DPI </h3><p>fcitx5会自动根据多显示器不同的DPI来调整界面大小，但离奇的是，在27寸显示器上的界面比在13寸笔记本显示器还小，造成了我的困扰，只得将这一功能关闭，并调整字体大小为14。</p><p>修改<code class="language-plaintext highlighter-rouge">~/.config/fcitx5/conf/classicui.conf</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 按屏幕 DPI 使用</span>
<span class="nv">PerScreenDPI</span><span class="o">=</span>False

<span class="c"># Font (设置成你喜欢的字体)</span>
<span class="nv">Font</span><span class="o">=</span><span class="s2">"Noto Sans Regular 14"</span>
</code></pre></div></div><h3 id="自定义快速输入"><a href="#自定义快速输入">#</a> 自定义快速输入 </h3><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo touch</span> /usr/share/fcitx5/data/quickphrase.d/quick.mb <span class="c">#在fcitx5数据文件夹建立mb文件</span>
<span class="nb">sudo </span>nano /usr/share/fcitx5/data/quickphrase.d/quick.mb <span class="c">#使用nano编辑</span>
</code></pre></div></div><p>在文件中添加形如<code class="language-plaintext highlighter-rouge">input output</code>的代码，一行一条，即可实现添加快速输入辞典。</p><p>示例：要在快速输入中输入<code class="language-plaintext highlighter-rouge">eg</code>，在候选中显示<code class="language-plaintext highlighter-rouge">e.g.</code>，只需在上述mb文件中添加一行<code class="language-plaintext highlighter-rouge">eg e.g.</code>即可。</p><p><em>友情提示：快速输入可以使用分号打开，Rime不支持快速输入。</em></p><h3 id="使用皮肤"><a href="#使用皮肤">#</a> 使用皮肤 </h3><p>我使用了<a href="https://github.com/hosxy/Fcitx5-Material-Color" target="_blank" rel="nofollow noopener noreferrer">hosxy的Material-color皮肤</a>，安装非常方便，依照Readme操作即可。</p><p>效果非常惊艳，堪比Windows自带输入法：</p><div class="post-img"><a href="/assets/img/in-post/post-fcitx5/pink.png" data-fancybox="gallery" data-caption="fcitx5 Material Color" data-path="post-fcitx5/pink.png" data-webpack="true"></a><em>fcitx5 Material Color</em></div><p>更有多种配色可选，简直美汁汁儿，大家快去给个Star趴！</p><h4 id="使用单行模式inline_preedit"><a href="#使用单行模式inline_preedit">#</a> 使用单行模式(inline_preedit) </h4><p>上图就是单行模式，非常好看，推荐开启</p><p>对于fcitx5自带pinyin 请修改 <code class="language-plaintext highlighter-rouge">~/.config/fcitx5/conf/pinyin.conf</code></p><p>对于fcitx5-rime，请新建/修改 <code class="language-plaintext highlighter-rouge">~/.config/fcitx5/conf/rime.conf</code></p><p>加入/修改以下内容：</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 可用时在应用程序中显示预编辑文本</span>
<span class="s">PreeditInApplication=True</span>
</code></pre></div></div><blockquote><p>2020/04/26 <a href="https://github.com/fcitx/fcitx5-chinese-addons/commit/afdba83d6ec00c0a73357a3cdd3b97f5f6c9ee50" target="_blank" rel="nofollow noopener noreferrer">PreeditInApplicaation的拼写错误</a>被修复，配置文件中应当采用正确的拼写。如果仍然采用错误拼写，将不能启用单行模式。</p></blockquote><h2 id="体验"><a href="#体验">#</a> 体验 </h2><p>总体来说，fcitx5的输入体验的确比上个版本好一些，输入相对来说比较流畅，输入中文分号不需要空格，而是按两下分号键，输入英文时自动切换为半角标点等等小功能比较贴心。</p><p>从外观来说，这一Material Color皮肤也是为其加分不少。</p><p>唯一的问题就是自动DPI功能似乎还需要更多的打磨，加油啊老K同学～</p></div><ul class="post-pager"><li class="pager--next"><a class="button" href="/wod/2020/03/30/wod-settings/" data-toggle="tooltip" data-placement="top" title="WoD的设置应该怎么做"> NEXT<br><span>WoD的设置应该怎么做</span></a></li><li class="pager--prev"><a class="button" href="/2020/03/25/learning-ruby/" data-toggle="tooltip" data-placement="top" title="Ruby学习心得"> PREV<br><span>Ruby学习心得</span></a></li></ul><div id="vcomments"></div></div></section><footer class="about condensed"><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></footer></main><script async src="https://www.googletagmanager.com/gtag/js?id=UA-159368053-1"></script><script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-159368053-1');
    </script></body></html>