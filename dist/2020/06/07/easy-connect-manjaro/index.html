<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="google-site-verification" content="zrVlHARQzSGPX8n0jKJdP_fCO0AvtLXxoPmYkJh-oXw"/><meta name="description" content="Act local, think global with DotIN13!"><meta name="keywords" content="Linux, EasyConnect, and Manjaro"><meta name="theme-color" content="#ff94c2"><meta lang="zh"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png?v=2bA3g2vyYK"><link rel="mask-icon" href="/assets/img/favicon/safari-pinned-tab.svg?v=2bA3g2vyYK" color="#dc2267"><link rel="shortcut icon" href="/assets/img/favicon/favicon.ico?v=2bA3g2vyYK"><meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/img/favicon/browserconfig.xml?v=2bA3g2vyYK"><meta property="og:title" content="如何在Manjaro Linux优雅地使用EasyConnect - DOTIN13'S BLOG"><meta property="og:type" content="article"><meta property="og:description" content="不会开发就不要开发 多数EasyConnect的Linux用户都遇到了一系列怪问题，在论坛发帖也鲜有回复，偶有客服搭话，也大多采用“您的系统不支持”、“我帮您查查”之类的托词推脱干系。 在网络遨游3个小时之后，总算找到了一些Workarounds，气不过，在此与大家分享。 版本不一致 在AUR安装最新版7.6.7之后，登陆时居然提示软件与服务器版本不一致，要求我“更新”。打开更新链接..."><meta property="article:published_time" content="2020-06-07T00:00:00Z"><meta property="article:author" content="DotIN13"><meta property="article:tag" content="Linux"><meta property="article:tag" content="EasyConnect"><meta property="article:tag" content="Manjaro"><meta property="og:image" content="https://www.wannaexpresso.com/assets/img/orange.webp"><meta property="og:url" content="https://www.wannaexpresso.com/2020/06/07/easy-connect-manjaro/"><meta property="og:site_name" content="DOTIN13'S BLOG"><link rel="canonical" href="https://www.wannaexpresso.com/2020/06/07/easy-connect-manjaro/"><script src="/assets/public/application-bundle.js"></script><link rel="stylesheet" href="/assets/public/application.css"><script src="/assets/public/posts-bundle.js"></script><title>如何在Manjaro Linux优雅地使用EasyConnect - DOTIN13'S BLOG</title></head><body><main class="container"><section class="about"><div class="about-header"><div class="about-title"><a href="/" id="avatar" data-caption="DotIN13" data-webpack="true" data-path="/assets/img/orange.webp"></a><h2 id="title"><a href="/">DotIN13</a></h2></div><p class="tagline">LACKAWANNA<br>EXPRESSO</p></div><div class="buttons"><a href="/en-us/" class="language-selection button icon-translate" aria-label="Change locale to English."></a><a href="/feed.xml" class="feed button icon-rss_feed" aria-label="RSS Feed"></a><input type="checkbox" class="dark-mode-toggle" aria-label="dark-mode-switch"><a href="#" aria-label="Click to toggle darkmode." class="button"><span class="icon-moon"></span><span class="icon-sun"></span></a><a href="#" id="pwa-install" class="install button icon-install disabled" aria-label="Install as Web Application"><span>Install</span></a></div><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></section><section class="content"><div class="post-container"><a class="post-link" href="/2020/06/07/easy-connect-manjaro/"><h2 class="post-title">如何在Manjaro Linux优雅地使用EasyConnect</h2><h3 class="post-subtitle">Elegantly Use EasyConnect on Manjaro Linux</h3></a><div class="post-meta"><div class="post-categories"><a class="button" href="/archive/?tag=Linux" title="Linux">Linux</a><a class="button" href="/archive/?tag=EasyConnect" title="EasyConnect">EasyConnect</a><a class="button" href="/archive/?tag=Manjaro" title="Manjaro">Manjaro</a></div><div class="post-misc"><div class="post-date"><i class="icon-calendar"></i>Jun 7, 2020</div></div></div><div class="post"><h2 id="不会开发就不要开发"><a href="#不会开发就不要开发">#</a> 不会开发就不要开发 </h2><p>多数EasyConnect的Linux用户都遇到了一系列怪问题，在论坛发帖也鲜有回复，偶有客服搭话，也大多采用“您的系统不支持”、“我帮您查查”之类的托词推脱干系。</p><p>在网络遨游3个小时之后，总算找到了一些Workarounds，气不过，在此与大家分享。</p><h2 id="版本不一致"><a href="#版本不一致">#</a> 版本不一致 </h2><p>在AUR安装最新版7.6.7之后，登陆时居然提示软件与服务器版本不一致，要求我“更新”。打开更新链接，下载了链接里的deb包，一安装，发现居然是降级到了7.6.3。也是不得不服。</p><p>如果你也遇到了同样的问题，首先需要到企业的EasyConnect下载页面下载对应版本的deb。由于各个企业服务端所用版本不同，所以下载页面都是由企业自行提供的。</p><h3 id="使用debtap安装deb包"><a href="#使用debtap安装deb包">#</a> 使用debtap安装deb包 </h3><p>首先安装AUR包管理器yay。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://aur.archlinux.org/yay.git
<span class="nb">cd </span>yay
makepkg <span class="nt">-si</span>
</code></pre></div></div><p>然后使用yay安装debtap。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yay <span class="nt">-S</span> debtap
</code></pre></div></div><p>请确保系统中已经安装了bash、binutils、pkgfile和fakeroot这几项debtap的依赖。</p><p>如果你身在国内，建议给debtap换源，否则软件包列表下载速度会让你怀疑人生。</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># /usr/bin/debtap
替换：http://ftp.debian.org/debian/dists
为：https://mirrors.ustc.edu.cn/debian/dists

替换：http://archive.ubuntu.com/ubuntu/dists
为：https://mirrors.ustc.edu.cn/ubuntu/dists/
</code></pre></div></div><p>执行更新命令，更新debtap的包列表。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>debtap <span class="nt">-u</span>
</code></pre></div></div><p>然后使用debtap转化刚才下载的deb包为Arch Linux软件包。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 需要填写包名EasyConnect和证书类型</span>
debtap &lt;easyconnect&gt;.deb
<span class="c"># 或者使用静默模式跳过问题</span>
debtap <span class="nt">-q</span> &lt;easyconnect&gt;.deb
</code></pre></div></div><p>Arch Linux软件包会生成在当前目录，以<code class="language-plaintext highlighter-rouge">.tar.xz</code>/<code class="language-plaintext highlighter-rouge">.tar.zst</code>为后缀。此时使用<code class="language-plaintext highlighter-rouge">pacman</code>安装转化后的软件包。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>pacman <span class="nt">-S</span> &lt;easyconnect&gt;.tar.zst
</code></pre></div></div><h2 id="不能启动"><a href="#不能启动">#</a> 不能启动 </h2><p>首先遇到的问题是不能启动。</p><p>此时cd到<code class="language-plaintext highlighter-rouge">/usr/share/sangfor/EasyConnect</code>。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /usr/share/sangfor/EasyConnect
<span class="c"># 在终端运行EasyConnect</span>
./EasyConnect
</code></pre></div></div><p>如果看到终端出错<code class="language-plaintext highlighter-rouge">Harfbuzz version is too old</code>，就代表系统的pango包版本过高，这是开发者没有更新软件的依赖所导致的。</p><p>由于不希望改变系统的运行库，我们可以把旧版的pango运行库放置到<code class="language-plaintext highlighter-rouge">/usr/share/sangfor/EasyConnect</code>，让EasyConnect能够调用。在没有进行额外操作的情况下，EasyConnect调用的是系统中的pango 1.44。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ldd EasyConnect | <span class="nb">grep </span>pango
	libpangocairo-1.0.so.0 <span class="o">=&gt;</span> /usr/lib/x86_64-linux-gnu/libpangocairo-1.0.so.0 <span class="o">(</span>0x00007f9713518000<span class="o">)</span>
	libpango-1.0.so.0 <span class="o">=&gt;</span> /usr/lib/x86_64-linux-gnu/libpango-1.0.so.0 <span class="o">(</span>0x00007f971337e000<span class="o">)</span>
	libpangoft2-1.0.so.0 <span class="o">=&gt;</span> /usr/lib/x86_64-linux-gnu/libpangoft2-1.0.so.0 <span class="o">(</span>0x00007f97116d8000<span class="o">)</span>
</code></pre></div></div><p>我们需要下载旧版的<code class="language-plaintext highlighter-rouge">libpango</code>、<code class="language-plaintext highlighter-rouge">libpangocairo</code>和<code class="language-plaintext highlighter-rouge">libpangoft</code>的deb包，然后解压运行库文件到<code class="language-plaintext highlighter-rouge">/usr/share/sangfor/EasyConnect</code>。以下给出1.42的下载链接。</p><blockquote><p><a href="https://packages.debian.org/buster/libpango-1.0-0" target="_blank" rel="nofollow noopener noreferrer">libpango下载地址</a></p><p><a href="https://packages.debian.org/buster/libpangocairo-1.0-0" target="_blank" rel="nofollow noopener noreferrer">libpangocairo下载地址</a></p><p><a href="https://packages.debian.org/buster/libpangoft2-1.0-0" target="_blank" rel="nofollow noopener noreferrer">libpangoft下载地址</a></p></blockquote><p>下载deb包后，打开deb包中的<code class="language-plaintext highlighter-rouge">data.tar.xz</code>，提取<code class="language-plaintext highlighter-rouge">data.tar.xz</code>中<code class="language-plaintext highlighter-rouge">/./usr/lib/x86_64-linux-gnu/</code>下的<code class="language-plaintext highlighter-rouge">.so.0</code>与<code class="language-plaintext highlighter-rouge">.so.0.4200.3</code>文件到<code class="language-plaintext highlighter-rouge">/usr/share/sangfor/EasyConnect</code>。</p><p>此时运行<code class="language-plaintext highlighter-rouge">ldd</code>命令输出如下。</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ldd EasyConnect | <span class="nb">grep </span>pango
	libpangocairo-1.0.so.0 <span class="o">=&gt;</span> /usr/share/sangfor/EasyConnect/./libpangocairo-1.0.so.0 <span class="o">(</span>0x00007f16ce009000<span class="o">)</span>
	libpango-1.0.so.0 <span class="o">=&gt;</span> /usr/share/sangfor/EasyConnect/./libpango-1.0.so.0 <span class="o">(</span>0x00007f16cde72000<span class="o">)</span>
	libpangoft2-1.0.so.0 <span class="o">=&gt;</span> /usr/share/sangfor/EasyConnect/./libpangoft2-1.0.so.0 <span class="o">(</span>0x00007f16cc1cb000<span class="o">)</span>
</code></pre></div></div><p>再从桌面打开EasyConnect，就能够正常启动了。</p><p>参考<a href="https://www.cnblogs.com/cocode/p/12890684.html" target="_blank" rel="nofollow noopener noreferrer">CNBLOG</a>。</p><h2 id="登陆闪退"><a href="#登陆闪退">#</a> 登陆闪退 </h2><p>登陆后小图标闪动数秒后闪退，是由于svpnservice没有正常启动。</p><p>首先打开EasyConnect和一个终端，在终端输入：</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> /usr/share/sangfor/EasyConnect/resources/shell/sslservice.sh
</code></pre></div></div><p>登陆时，当登陆进度条运行至70%左右，在终端回车运行命令。</p><p>终端提示：</p><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sslservice.sh start ...
start CSClient seccess!
start svpnservice seccess!
</code></pre></div></div><p>此时SSLVPN就能够正常连接了。</p><h2 id="总结"><a href="#总结">#</a> 总结 </h2><p>开发的时候，还需多一点完美主义。</p></div><ul class="post-pager"><li class="pager--next"><a class="button" href="/2020/07/07/chenhuansheng-downtown/" data-toggle="tooltip" data-placement="top" title="陈奂生上城"> NEXT<br><span>陈奂生上城</span></a></li><li class="pager--prev"><a class="button" href="/2020/06/06/rails-development-3/" data-toggle="tooltip" data-placement="top" title="RoR开发日志三 Capistrano + Puma + Caddy部署特辑"> PREV<br><span>RoR开发日志三 Capistrano + Puma + Caddy部署特辑</span></a></li></ul><div id="vcomments"></div></div></section><footer class="about condensed"><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></footer></main><script async src="https://www.googletagmanager.com/gtag/js?id=UA-159368053-1"></script><script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-159368053-1');
    </script></body></html>