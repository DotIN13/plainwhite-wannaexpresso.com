<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="google-site-verification" content="zrVlHARQzSGPX8n0jKJdP_fCO0AvtLXxoPmYkJh-oXw"/><meta name="description" content="Act local, think global with DotIN13!"><meta name="keywords" content="Linux, Aria2, and Aria2NG"><meta name="theme-color" content="#ff94c2"><meta lang="zh"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png?v=2bA3g2vyYK"><link rel="mask-icon" href="/assets/img/favicon/safari-pinned-tab.svg?v=2bA3g2vyYK" color="#dc2267"><link rel="shortcut icon" href="/assets/img/favicon/favicon.ico?v=2bA3g2vyYK"><meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/img/favicon/browserconfig.xml?v=2bA3g2vyYK"><meta property="og:title" content="在Manjaro中优雅地使用Aria2NG - DOTIN13'S BLOG"><meta property="og:type" content="article"><meta property="og:description" content="安装Aria2 Aria2是一款优秀的跨平台下载程序，支持http、magnet、bt等多种协议。在Manjaro中可以直接搜索安装aria2软件包。 安装后建议自行建立aria专用文件夹，并手动创建以下三个配置文件：aria2.conf、aria2.session、aria2.log。 aria2.conf示例 dir=/home/dotin13/Downloads # 启用磁盘缓存..."><meta property="article:published_time" content="2020-02-23T16:08:00Z"><meta property="article:author" content="DotIN13"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Aria2"><meta property="article:tag" content="Aria2NG"><meta property="og:image" content="https://www.wannaexpresso.com/assets/img/orange.webp"><meta property="og:url" content="https://www.wannaexpresso.com/2020/02/23/manjaro-aria2ng/"><meta property="og:site_name" content="DOTIN13'S BLOG"><link rel="canonical" href="https://www.wannaexpresso.com/2020/02/23/manjaro-aria2ng/"><script src="/assets/public/application-bundle.js"></script><link rel="stylesheet" href="/assets/public/application.css"><script src="/assets/public/posts-bundle.js"></script><title>在Manjaro中优雅地使用Aria2NG - DOTIN13'S BLOG</title></head><body><main class="container"><section class="about"><div class="about-header"><div class="about-title"><a href="/" id="avatar" data-caption="DotIN13" data-webpack="true" data-path="/assets/img/orange.webp"></a><h2 id="title"><a href="/">DotIN13</a></h2></div><p class="tagline">LACKAWANNA<br>EXPRESSO</p></div><div class="buttons"><a href="/en-us/" class="language-selection button icon-translate" aria-label="Change locale to English."></a><a href="/feed.xml" class="feed button icon-rss_feed" aria-label="RSS Feed"></a><input type="checkbox" class="dark-mode-toggle" aria-label="dark-mode-switch"><a href="#" aria-label="Click to toggle darkmode." class="button"><span class="icon-moon"></span><span class="icon-sun"></span></a><a href="#" id="pwa-install" class="install button icon-install disabled" aria-label="Install as Web Application"><span>Install</span></a></div><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></section><section class="content"><div class="post-container"><a class="post-link" href="/2020/02/23/manjaro-aria2ng/"><h2 class="post-title">在Manjaro中优雅地使用Aria2NG</h2><h3 class="post-subtitle">Using Aria2NG in Manjaro</h3></a><div class="post-meta"><div class="post-categories"><a class="button" href="/archive/?tag=Linux" title="Linux">Linux</a><a class="button" href="/archive/?tag=Aria2" title="Aria2">Aria2</a><a class="button" href="/archive/?tag=Aria2NG" title="Aria2NG">Aria2NG</a></div><div class="post-misc"><div class="post-date"><i class="icon-calendar"></i>Feb 23, 2020</div></div></div><div class="post"><h2> 安装<code>Aria2</code></h2><p><code>Aria2</code>是一款优秀的跨平台下载程序，支持http、magnet、bt等多种协议。在Manjaro中可以直接搜索安装<code>aria2</code>软件包。</p><a href="https://sunpma.com/usr/uploads/2019/07/981191327.jpg" data-fancybox="gallery"><img border="0" src="https://sunpma.com/usr/uploads/2019/07/981191327.jpg"/></a><p>安装后建议自行建立aria专用文件夹，并手动创建以下三个配置文件：<code>aria2.conf</code>、<code>aria2.session</code>、<code>aria2.log</code>。</p><details><summary>aria2.conf示例</summary><figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">dir=/home/dotin13/Downloads</span>
<span class="c1"># 启用磁盘缓存, 0为禁用缓存, 需1.16以上版本, 默认:16M</span>
<span class="c1">#disk-cache=32M</span>
<span class="c1"># 文件预分配方式, 能有效降低磁盘碎片, 默认:prealloc</span>
<span class="c1"># 预分配所需时间: none &lt; falloc ? trunc &lt; prealloc</span>
<span class="c1"># falloc和trunc则需要文件系统和内核支持</span>
<span class="c1"># NTFS建议使用falloc, EXT3/4建议trunc, MAC 下需要注释此项</span>
<span class="c1">#file-allocation=trunc</span>

<span class="s">continue=true</span>

<span class="c1">## 下载连接相关 ##</span>

<span class="c1"># 最大同时下载任务数, 运行时可修改, 默认:5</span>
<span class="s">max-concurrent-downloads=5</span>
<span class="c1"># 同一服务器连接数, 添加时可指定, 默认:1</span>
<span class="s">max-connection-per-server=16</span>
<span class="c1"># 最小文件分片大小, 添加时可指定, 取值范围1M -1024M, 默认:20M</span>
<span class="c1"># 假定size=10M, 文件为20MiB 则使用两个来源下载; 文件为15MiB 则使用一个来源下载</span>
<span class="s">min-split-size=10M</span>
<span class="c1"># 单个任务最大线程数, 添加时可指定, 默认:5</span>
<span class="s">split=5</span>
<span class="c1"># 整体下载速度限制, 运行时可修改, 默认:0</span>
<span class="c1">#max-overall-download-limit=0</span>
<span class="c1"># 单个任务下载速度限制, 默认:0</span>
<span class="c1">#max-download-limit=0</span>
<span class="c1"># 整体上传速度限制, 运行时可修改, 默认:0</span>
<span class="s">max-overall-upload-limit=10K</span>
<span class="c1"># 单个任务上传速度限制, 默认:0</span>
<span class="s">max-upload-limit=20</span>
<span class="c1"># 禁用IPv6, 默认:false</span>
<span class="s">disable-ipv6=true</span>

<span class="c1">## 进度保存相关 ##</span>

<span class="c1"># 从会话文件中读取下载任务</span>
<span class="s">input-file=/home/dotin13/Documents/aria2/aria2.session</span>
<span class="c1"># 在Aria2退出时保存`错误/未完成`的下载任务到会话文件</span>
<span class="s">save-session=/home/dotin13/Documents/aria2/aria2.session</span>
<span class="c1"># 定时保存会话, 0为退出时才保存, 需1.16.1以上版本, 默认:0</span>
<span class="c1">#save-session-interval=60</span>

<span class="c1">## RPC相关设置 ##</span>

<span class="c1"># 启用RPC, 默认:false</span>
<span class="s">enable-rpc=true</span>
<span class="c1"># 允许所有来源, 默认:false</span>
<span class="s">rpc-allow-origin-all=true</span>
<span class="c1"># 允许非外部访问, 默认:false</span>
<span class="s">rpc-listen-all=true</span>
<span class="c1"># 事件轮询方式, 取值:[epoll, kqueue, port, poll, select], 不同系统默认值不同</span>
<span class="c1">#event-poll=select</span>
<span class="c1"># RPC监听端口, 端口被占用时可以修改, 默认:6800</span>
<span class="c1">#rpc-listen-port=6800</span>
<span class="c1"># 设置的RPC授权令牌, v1.18.4新增功能, 取代 --rpc-user 和 --rpc-passwd 选项</span>
<span class="s">rpc-secret=secret</span>
<span class="c1"># 设置的RPC访问用户名, 此选项新版已废弃, 建议改用 --rpc-secret 选项</span>
<span class="c1">#rpc-user=&lt;USER&gt;</span>
<span class="c1"># 设置的RPC访问密码, 此选项新版已废弃, 建议改用 --rpc-secret 选项</span>
<span class="c1">#rpc-passwd=&lt;PASSWD&gt;</span>

<span class="c1">## BT/PT下载相关 ##</span>

<span class="c1"># 当下载的是一个种子(以.torrent结尾)时, 自动开始BT任务, 默认:true</span>
<span class="c1">#follow-torrent=true</span>
<span class="c1"># BT监听端口, 当端口被屏蔽时使用, 默认:6881-6999</span>
<span class="s">listen-port=51413</span>
<span class="c1"># 单个种子最大连接数, 默认:55</span>
<span class="c1">#bt-max-peers=55</span>
<span class="c1"># 打开DHT功能, PT需要禁用, 默认:true</span>
<span class="c1">#enable-dht=false</span>
<span class="c1"># 打开IPv6 DHT功能, PT需要禁用</span>
<span class="s">enable-dht6=false</span>
<span class="c1"># DHT网络监听端口, 默认:6881-6999</span>
<span class="c1">#dht-listen-port=6881-6999</span>
<span class="c1"># 本地节点查找, PT需要禁用, 默认:false</span>
<span class="c1">#bt-enable-lpd=false</span>
<span class="c1"># 种子交换, PT需要禁用, 默认:true</span>
<span class="s">enable-peer-exchange=false</span>
<span class="c1"># 每个种子限速, 对少种的PT很有用, 默认:50K</span>
<span class="c1">#bt-request-peer-speed-limit=50K</span>
<span class="c1"># 客户端伪装, PT需要</span>
<span class="c1">#peer-id-prefix=-TR2770-</span>
<span class="c1">#user-agent=Transmission/2.77</span>
<span class="c1"># 当种子的分享率达到这个数时, 自动停止做种, 0为一直做种, 默认:1.0</span>
<span class="c1">#seed-ratio=0</span>
<span class="c1"># 强制保存会话, 话即使任务已经完成, 默认:false</span>
<span class="c1"># 较新的版本开启后会在任务完成后依然保留.aria2文件</span>
<span class="c1">#force-save=false</span>
<span class="c1"># BT校验相关, 默认:true</span>
<span class="c1">#bt-hash-check-seed=true</span>
<span class="c1"># 继续之前的BT任务时, 无需再次校验, 默认:false</span>
<span class="s">bt-seed-unverified=true</span>
<span class="c1"># 保存磁力链接元数据为种子文件(.torrent文件), 默认:false</span>
<span class="s">bt-save-metadata=true</span></code></pre></figure></details><h2> 配置<code>Aria2</code>开机启动 </h2><p>在<code>/lib/systemd/system/aria2.service</code>编写如下脚本：</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>Unit]
<span class="nv">Description</span><span class="o">=</span> aria2
<span class="nv">After</span><span class="o">=</span>network.target
 
<span class="o">[</span>Service]
<span class="c">#PIDFile=/run/aria2.pid</span>
<span class="nv">ExecStart</span><span class="o">=</span>aria2c <span class="nt">-c</span> <span class="nt">--conf-path</span><span class="o">=</span>/home/dotin13/Documents/aria2/aria2.conf &amp;
<span class="nv">ExecStop</span><span class="o">=</span>/bin/kill <span class="nv">$MAINPID</span>
<span class="nv">RestartSec</span><span class="o">=</span>always
 
<span class="o">[</span>Install]
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target</code></pre></figure><p>然后使用以下命令即可做到开机自启动：</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">systemctl <span class="nb">enable </span>aria2.service
systemctl start aria2.service</code></pre></figure><h2> 安装<code>Aria2NG</code></h2><div class="post-img"><a href="/assets/img/in-post/post-aria2ng/screenshot-1.png" data-fancybox="gallery" data-caption="Aria2NG" data-path="post-aria2ng/screenshot-1.png" data-webpack=true></a><em>Aria2NG</em></div><br><code>Aria2NG</code>是一款优秀的<code>Aria2</code>管理前端，相当于是<code>Aria2</code>的GUI，极大方便<code>Aria2</code>的使用。在Manjaro中可以直接搜索安装<code>ariang-allinone</code>软件包。 <h2> 将<code>Aria2NG</code>添加到<code>Favorites</code></h2><p>运行以下命令：</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">touch </span>aria2ng.desktop
nano aria2ng.desktop</code></pre></figure><p>将以下内容写入<code>aria2ng.desktop</code>中。</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>Desktop Entry]
<span class="nv">Encoding</span><span class="o">=</span>UTF-8
<span class="nv">Version</span><span class="o">=</span>1.0
Name[en_US]<span class="o">=</span>Aria2NG
<span class="nv">GenericName</span><span class="o">=</span>Aria2NG
<span class="c"># 用Chromium打开Aria2NG-Allinone</span>
<span class="nv">Exec</span><span class="o">=</span>chromium /usr/share/ariang-allinone/index.html
<span class="c"># 不需要开启终端</span>
<span class="nv">Terminal</span><span class="o">=</span><span class="nb">false</span>
<span class="c"># 你的图标文件</span>
Icon[en_US]<span class="o">=</span>/home/dotin13/Documents/aria2/aria.png
<span class="nv">Type</span><span class="o">=</span>Application
<span class="nv">Categories</span><span class="o">=</span>Application<span class="p">;</span>Network<span class="p">;</span>Security<span class="p">;</span>
Comment[en_US]<span class="o">=</span>Aria2NG</code></pre></figure><p>保存后，再将<code>.desktop</code>文件移动到<code>applications</code>文件夹中去。</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">mv </span>aria2ng.desktop ~/.local/share/applications/</code></pre></figure><p>进入<code>Show Applications</code>界面，搜索刚刚添加的<code>Aria2NG</code>快捷方式，右键添加到<code>Favorites</code>。</p></div><ul class="post-pager"><li class="pager--next"><a class="button" href="/2020/02/28/apple-music-library/" data-toggle="tooltip" data-placement="top" title="导入Apple Music Library到网易云音乐"> NEXT<br><span>导入Apple Music Library到网易云音乐</span></a></li><li class="pager--prev"><a class="button" href="/2020/02/23/manjaro-qq-wechat/" data-toggle="tooltip" data-placement="top" title="在Manjaro中优雅地使用QQ与Wechat"> PREV<br><span>在Manjaro中优雅地使用QQ与Wechat</span></a></li></ul><div id="vcomments"></div></div></section><footer class="about condensed"><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></footer></main><script async src="https://www.googletagmanager.com/gtag/js?id=UA-159368053-1"></script><script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-159368053-1');
    </script></body></html>