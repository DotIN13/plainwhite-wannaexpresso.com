<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="google-site-verification" content="zrVlHARQzSGPX8n0jKJdP_fCO0AvtLXxoPmYkJh-oXw"/><meta name="description" content="Act local, think global with DotIN13!"><meta name="keywords" content="Batch Replacer, VSCode, Jekyll, Rouge, and RegExp"><meta name="theme-color" content="#ff94c2"><meta lang="zh"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon/apple-touch-icon.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon/favicon-32x32.png?v=2bA3g2vyYK"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon/favicon-16x16.png?v=2bA3g2vyYK"><link rel="mask-icon" href="/assets/img/favicon/safari-pinned-tab.svg?v=2bA3g2vyYK" color="#dc2267"><link rel="shortcut icon" href="/assets/img/favicon/favicon.ico?v=2bA3g2vyYK"><meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/img/favicon/browserconfig.xml?v=2bA3g2vyYK"><meta property="og:title" content="用Batch Replacer轻松切换到Rouge高亮引擎 - DOTIN13'S BLOG"><meta property="og:type" content="article"><meta property="og:description" content="问题 从Blogger迁移到Jekyll+Zeit之后，由于Jekyll不支持在HTML中渲染Markdown，所以像下面这样嵌在details中的代码段不会被高亮显示。 &lt;details&gt; &lt;summary&gt;BlahBlah&lt;/summary&gt; ```lang ... ``` &lt;/details&gt; 跟别提..."><meta property="article:published_time" content="2020-04-05T00:00:00Z"><meta property="article:author" content="DotIN13"><meta property="article:tag" content="Batch Replacer"><meta property="article:tag" content="VSCode"><meta property="article:tag" content="Jekyll"><meta property="article:tag" content="Rouge"><meta property="article:tag" content="RegExp"><meta property="og:image" content="https://www.wannaexpresso.com/assets/img/orange.webp"><meta property="og:url" content="https://www.wannaexpresso.com/2020/04/05/batch-refit/"><meta property="og:site_name" content="DOTIN13'S BLOG"><link rel="canonical" href="https://www.wannaexpresso.com/2020/04/05/batch-refit/"><script src="/assets/public/application-bundle.js"></script><link rel="stylesheet" href="/assets/public/application.css"><script src="/assets/public/posts-bundle.js"></script><title>用Batch Replacer轻松切换到Rouge高亮引擎 - DOTIN13'S BLOG</title></head><body><main class="container"><section class="about"><div class="about-header"><div class="about-title"><a href="/" id="avatar" data-caption="DotIN13" data-webpack="true" data-path="/assets/img/orange.webp"></a><h2 id="title"><a href="/">DotIN13</a></h2></div><p class="tagline">LACKAWANNA<br>EXPRESSO</p></div><div class="buttons"><a href="/en-us/" class="language-selection button icon-translate" aria-label="Change locale to English."></a><a href="/feed.xml" class="feed button icon-rss_feed" aria-label="RSS Feed"></a><input type="checkbox" class="dark-mode-toggle" aria-label="dark-mode-switch"><a href="#" aria-label="Click to toggle darkmode." class="button"><span class="icon-moon"></span><span class="icon-sun"></span></a><a href="#" id="pwa-install" class="install button icon-install disabled" aria-label="Install as Web Application"><span>Install</span></a></div><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></section><section class="content"><div class="post-container"><a class="post-link" href="/2020/04/05/batch-refit/"><h2 class="post-title">用Batch Replacer轻松切换到Rouge高亮引擎</h2><h3 class="post-subtitle">Fix Highlighting in Imported Posts with Batch Replacer</h3></a><div class="post-meta"><div class="post-categories"><a class="button" href="/archive/?tag=Batch+Replacer" title="Batch Replacer">Batch Replacer</a><a class="button" href="/archive/?tag=VSCode" title="VSCode">VSCode</a><a class="button" href="/archive/?tag=Jekyll" title="Jekyll">Jekyll</a><a class="button" href="/archive/?tag=Rouge" title="Rouge">Rouge</a><a class="button" href="/archive/?tag=RegExp" title="RegExp">RegExp</a></div><div class="post-misc"><div class="post-date"><i class="icon-calendar"></i>Apr 5, 2020</div></div></div><div class="post"><h2 id="问题"><a href="#问题">#</a> 问题 </h2><p>从Blogger迁移到Jekyll+Zeit之后，由于Jekyll不支持在HTML中渲染Markdown，所以像下面这样嵌在<code class="language-plaintext highlighter-rouge">details</code>中的代码段不会被高亮显示。</p><figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;details&gt;</span>
    <span class="nt">&lt;summary&gt;</span>BlahBlah<span class="nt">&lt;/summary&gt;</span>
    ```lang
    ...
    ```
<span class="nt">&lt;/details&gt;</span></code></pre></figure><p>跟别提我从Blogger导入的代码段，还都使用着Highlight.js的语法，这样的代码会直接被Rouge无视：</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;pre&gt;&lt;code</span> <span class="na">class=</span><span class="s">"lang"</span><span class="nt">&gt;</span>
    ...
<span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</code></pre></div></div><p>于是，迁移到Jekyll后，为了在<code class="language-plaintext highlighter-rouge">&lt;details&gt;</code>中插入代码，仍然选用了highlight.js作为代码高亮引擎。</p><p>但在更换主题到plainwhite之后，我作为强迫症患者，想保留Rouge，摆脱Highlight.js，与时俱进。这就涉及到怎么将上面的代码段替换成Rouge支持的语法。</p><h2 id="解决"><a href="#解决">#</a> 解决 </h2><p>在网上翻阅Rouge的资料，发现Rouge除了兼容Markdown的代码块之外，还兼容liquid。其语法如下：</p><div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{%</span><span class="w"> </span><span class="nt">highlight</span><span class="w"> </span>lang<span class="w"> </span><span class="p">%}</span>
...
<span class="p">{%</span><span class="w"> </span><span class="nt">endhighlight</span><span class="w"> </span><span class="p">%}</span>
</code></pre></div></div><p>所以只要将上面提到的<code class="language-plaintext highlighter-rouge">&lt;pre&gt;</code>替换成这边的<code class="language-plaintext highlighter-rouge">{% highlight lang %}</code>就阔以了。但我可不想手动操作，抱着试一试的心态，在Eric鸽鸽吹上天的VSCode里寻找批量替换的插件。没想到还真的给我找着了，<a href="https://marketplace.visualstudio.com/items?itemName=angelomollame.batch-replacer" target="_blank" rel="nofollow noopener noreferrer">Batch Replacer</a>这一插件支持一键替换Workspace中所有的文件内容，并且语法还支持RegExp。</p><div class="post-img"><a href="/assets/img/in-post/post-batch-replacer/batch-replacer.png" data-fancybox="gallery" data-caption="Batch Replacer Extension" data-path="post-batch-replacer/batch-replacer.png" data-webpack="true"></a><em>Batch Replacer Extension</em></div><p>刚学会了RegExp的我摩拳擦掌，跃跃欲试，编写了下面这段替换代码。</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>replace-regex "&lt;pre&gt;\s*&lt;code class="([^"]*)"&gt;"
with "{% highlight $1 %}"

replace-regex "&lt;/code&gt;\s*&lt;/pre&gt;"
with "{% endhighlight %}"
</code></pre></div></div><p>在Workspace添加_post文件夹，按下<code class="language-plaintext highlighter-rouge">Ctrl+Shift+P</code>，键入<code class="language-plaintext highlighter-rouge">Batch Refit</code>，回车，大功告成。</p><p>现在所有的Highlight.js语法的代码块都已经被替换成了Rouge代码块，即便被包裹在HTML代码中，也能够被轻松识别渲染，是不是很机智呢，哈哈哈哈哈！</p></div><ul class="post-pager"><li class="pager--next"><a class="button" href="/2020/04/20/epon-modem-bridge/" data-toggle="tooltip" data-placement="top" title="将电信EPON光猫切换到桥接模式"> NEXT<br><span>将电信EPON光猫切换到桥接模式</span></a></li><li class="pager--prev"><a class="button" href="/2020/04/04/wod-scripts/" data-toggle="tooltip" data-placement="top" title="给WoD写Tampermonkey脚本的那些事儿"> PREV<br><span>给WoD写Tampermonkey脚本的那些事儿</span></a></li></ul><div id="vcomments"></div></div></section><footer class="about condensed"><ul class="social condensed"><li><a target="_blank" rel="noreferrer" href="https://github.com/DotIN13" aria-label="GitHub Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://www.facebook.com/peter.zhang.1466" aria-label="Facebook Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-facebook fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://twitter.com/DotIN13" aria-label="Twitter Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="fab icon-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target="_blank" rel="noreferrer" href="https://space.bilibili.com/4471331" aria-label="Bilibili Social Link"><span class="fa-stack fa-2x"><i class="fas icon-circle fa-stack-2x"></i><i class="icon-bilibili fa-stack-1x fa-inverse"></i></span></a></li></ul><nav class="navigation condensed"><ul><li><a href="/about">About</a></li><li><a href="/archive">Archive</a></li></ul></nav><section class="about-footer condensed"><div><a href="https://icp.gov.moe" rel="noreferrer" target="_blank">Moe ICP </a><a href="https://icp.gov.moe/?keyword=20201620" target="_blank" rel="noreferrer">20201620</a></div><div><a rel="noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC-BY-SA 4.0</a></div></section></footer></main><script async src="https://www.googletagmanager.com/gtag/js?id=UA-159368053-1"></script><script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-159368053-1');
    </script></body></html>